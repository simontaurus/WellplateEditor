class Form{constructor(){}static open(t){if(void 0===t)return void console.error("No options provided to Form.open(). Aborted");let e=t.ID;void 0!==e&&""!==e?(this.Dialogs?(0==this.Dialogs&&this.addMask(),this.Dialogs++):(this.Dialogs=1,this.addMask()),this.Dialogs>1&&(document.getElementsByClassName("Form_Mask")[0].remove(),this.addMask()),this.initForm(t)):console.error("No id provided to Form.open(). Aborted")}static close(t){if(void 0===t||""===t)return void console.error("No options provided to Form.close(). Aborted");let e=GetId(t);e&&e.remove(),this.closeMask(),this.Dialogs&&(this.Dialogs--,this.Dialogs>0&&this.addMask({Location:"beforebegin"}))}static replaceButtons(t,e){let i=GetId(t);if(null===i)return console.warn("Form '"+t+"' not accessible for buttons replacement"),this;void 0===e&&(e=[]),i.getElementsByClassName("Form_Footer")[0].replaceWith(this.footer({Buttons:e}))}static addMask(t){let e=document.createElement("div");e.className="Form_Mask",t&&t.Location?document.body.lastChild.insertAdjacentElement(t.Location,e):document.body.append(e),e.addEventListener("mousemove",function(t){this.move(t)}.bind(this))}static closeMask(){let t=document.getElementsByClassName("Form_Mask")[0];t&&t.remove()}static initForm(t){let e=document.createElement("div");e.className="Form_Wrapper",e.id=t.ID;let i=t.Size||400;e.style.width=i+"px",e.style.left=(window.innerWidth-i)/2+window.pageXOffset+15*(this.Dialogs-1)+"px",e.style.top=window.innerHeight/4+window.pageYOffset+15*(this.Dialogs-1)+"px",e.innerHTML=this.header(i,t)+this.body(t),e.append(this.footer(t)),document.body.append(e),t.onInit&&t.onInit(),e.getElementsByClassName("Form_Closure")[0].addEventListener("click",(function(){t.onCancel&&t.onCancel(),Form.close(e.id)})),e.getElementsByClassName("Form_Header")[0].addEventListener("mousemove",function(t){this.move(t,e)}.bind(this)),e.addEventListener("mousemove",function(t){this.move(t)}.bind(this))}static header(t,e){let i='<div class="Form_Header">';if(e.Title){i+='<div class="Form_Title" style="width: '+(t-50)+'px">'+e.Title+"</div>"}return i+='<div class="Form_Closure" title="Close">&times;</div>',i+="</div>",i}static body(t){let e='<div class="Form_Body">';return t.HTML&&(e+=t.HTML),e+="</div>",e}static footer(t){let e=document.createElement("div");return e.className="Form_Footer",t.Buttons&&t.Buttons.forEach((function(t,i){i>0&&e.insertAdjacentHTML("beforeend","&nbsp;"),e.append(LinkCtrl.button(t))})),e}static move(t,e){if(1==t.buttons){let i=this.Moving;if(i){let e=this.Moving.Form;e.style.top=i.Top-(i.StartY-t.clientY)+"px",e.style.left=i.Left-(i.StartX-t.clientX)+"px"}else e&&(this.Moving={StartX:t.clientX,StartY:t.clientY,Top:e.offsetTop,Left:e.offsetLeft,Form:e})}else this.Moving=void 0}static download(t,e){let i="text/plain;charset=utf-8",s="download.txt";e.DataType&&(i=e.DataType),e.FileName&&(s=e.FileName);let n=URL.createObjectURL(new Blob([t],{type:i})),l="Form_Download";Form.open({ID:l,HTML:'<p>Click on the link below to download and save your file:</p><p style="text-align: center;"><a href="'+n+'" download="'+s+'">'+s+"</a></p>",Title:"Download file",Buttons:[{Label:"Close",Click:function(){URL.revokeObjectURL(n),Form.close(l)}}]})}}class LinkCtrl{constructor(t){this.ID=t.ID,this.Default=t.Default,this.Value=t.Default,this.Title=t.Title||"",this.Label=t.Label||"",this.ControlLeft=t.ControlLeft||!1,this.NewLine=t.NewLine||!1,this.Preserve=t.Preserve||!1,this.change=t.Change||function(t){}.bind(this),this.Chain=t.Chain,this.Chain?this.Index=this.Chain.Index:t.Index&&t.Index>-1?this.Index=t.Index:this.Index=0,this.Disabled=t.Disabled,this.Me=this.ID+"_"+this.Index,this.Control=this.Me+"_Control"}static new(t,e){if(void 0!==e)if(void 0!==e.ID&&""!=e.ID)if(void 0!==e.Default)switch(t){case"Checkbox":return new LinkCtrl_Checkbox(e);case"Text":return new LinkCtrl_Text(e);case"TextArea":return new LinkCtrl_TextArea(e);case"Number":return new LinkCtrl_Number(e);case"Select":return new LinkCtrl_Select(e);case"Color":return new LinkCtrl_Color(e);case"Radio":return new LinkCtrl_Radio(e);case"File":return new LinkCtrl_File(e);default:return void console.error("Unknown type requested for LinkCtrl ("+t+"). Aborted.")}else console.error("Required default value missing for LinkCtrl. Aborted.");else console.error("Required ID missing for LinkCtrl. Aborted.");else console.error("Required options missing for LinkCtrl. Aborted.")}static button(t){if(void 0!==t){var e=document.createElement("span"),i="LinkCtrl LinkCtrl_Round";if(t.Disabled?i+=" LinkCtrl_Disabled":i+=" LinkCtrl_Resting",e.style.whiteSpace="pre",e.className=i,t.ID&&(e.id=t.ID),t.Title&&(e.title=t.Title),t.Label&&(e.innerHTML=t.Label),t.Icon){let i=this.icon(t.Icon);t.Icon.Left?e.insertAdjacentHTML("afterbegin",i):e.insertAdjacentHTML("beforeend",i)}return t.Click&&!t.Disabled&&e.addEventListener("click",t.Click),e}console.error("Required options missing for Button. Aborted.")}static buttonBar(t,e){if(void 0!==t){var i=document.createElement("div");return e&&(i.className="LinkCtrl_Inline"),t.forEach((function(t,e){e>0&&i.insertAdjacentHTML("beforeend"," "),i.append(this.button(t))}),this),i}console.error("Required buttons missing for button bar. Aborted.")}static icon(t){let e="";switch(t.Space&&(e+="&nbsp;"),e+='<span class="LinkCtrl_Icon',void 0!==t.Active&&(t.Active?e+=" LinkCtrl_IconActive":e+=" LinkCtrl_IconResting"),t.Size){case"Big":e+=" LinkCtrl_IconBig";break;case"Medium":e+=" LinkCtrl_IconMedium";break;default:e+=" LinkCtrl_IconSmall"}e+='"',t.Title&&(e+=' title="'+t.Title+'"'),t.Attributes&&t.Attributes.forEach((function(t){e+=" "+t.Name+'="'+t.Value+'"'}));let i="";switch(t.Type){case"Reset":i="0px 0px";break;case"Setting":i="-50px 0px";break;case"Zoom":i="-100px 0px";break;case"Move":i="-150px 0px";break;case"Delete":i="-200px 0px";break;case"Edit":i="0px -50px";break;case"Tag":i="-50px -50px";break;case"Ok":i="-100px -50px";break;case"Cancel":i="-150px -50px";break;case"Back":i="-200px -50px";break;case"Up":i="0px -100px";break;case"Down":i="-50px -100px";break;case"Bottom":i="-100px -100px";break;case"Top":i="-150px -100px";break;case"Load":i="-200px -100px";break;case"Save":i="0px -150px";break;case"ZoomOut":i="-50px -150px";break;case"ZoomIn":i="-100px -150px";break;case"New":i="-150px -150px";break;case"Warning":i="-200px -150px";break;case"Left":i="0px -200px";break;case"Right":i="-50px -200px";break;case"Last":i="-100px -200px";break;case"First":i="-150px -200px";break;default:i="-200px -200px"}let s="";switch(t.Color){case"Red":s=" filter: sepia(100%) saturate(1500%)";break;case"Green":s=" filter: sepia(100%) saturate(2000%) hue-rotate(100deg)";break;case"Yellow":s=" filter: sepia(50%) hue-rotate(15deg) saturate(5000%)"}return e+='style="background-position: '+i+";"+s+'"></span>',e}get Classes(){return this.getClass()}get HasLabel(){return this.Label.length>0}getClass(t){let e="";if("Checkbox"==this.Type&&this.Value?e+=" LinkCtrl_Active":this.Disabled?e+=" LinkCtrl_Disabled":e+=" LinkCtrl_Resting",t&&t.ForceMiddle)return e;let i=this.Chain;if(i){if(0==i.Index||i.NewLine?void 0!==t&&void 0!==t.RightOnly||(e+=" LinkCtrl_RoundL"):e+=" LinkCtrl_Chain",i.Last){if(t&&t.LeftOnly)return e;e+=" LinkCtrl_RoundR"}}else t&&t.RightOnly?e+=" LinkCtrl_RoundR":t&&t.LeftOnly?e+=" LinkCtrl_RoundL":e+=" LinkCtrl_Round";return e}init(){let t=GetId(this.ID);if(null==t)return console.warn("DOM element for LinkCtrl not found, init() method aborted"),this;let e=this.html();return this.Chain&&this.Chain.NewLine&&(e="<br>"+this.html()),this.Chain&&this.Index>0||this.Preserve?t.insertAdjacentHTML("beforeend",e):t.innerHTML=e,this.bindEvents(),this}bindEvents(){console.warn("bindEvents function not defined for this control; no events attached")}setValue(t){var e=GetId(this.Me);return this.updateValue(t,e),this}getValue(){return this.Value}setDefault(t){return this.Default=t,this}default(){return this.setValue(this.Default)}remove(){var t=GetId(this.Me);return null===t||t.remove(),this}focus(){var t=GetId(this.Me);return t&&t.focus(),this}}class RespTable{constructor(t){return this.ID=t.ID,this.Array=t.Array||[],this.Multiple=t.Multiple||!1,this.Headers=t.Headers,this.Fields=t.Fields,this.RowNumbers=t.RowNumbers,this.FullWidth=t.FullWidth,this.MaxHeight=t.MaxHeight||250,this.Delegate=t.Delegate,this.onSelect=t.onSelect,this.onDelete=t.onDelete,this.onUpdate=t.onUpdate,this.Preserve=t.Preserve,this.NoControls=t.NoControls,this.Me=this.ID+"_RespTable",this}get Length(){return this.Array.length}get SelectedIndices(){let t=[];return this.Array.forEach((function(e,i){e.Selected&&t.push(i)})),t}get Selected(){return this.Array.filter((function(t){return t.Selected}))}init(){let t=GetId(this.ID);if(null==t)return this;let e="<div";if(this.MaxHeight>0&&(e+=' style="max-height: '+this.MaxHeight+'px; overflow: auto"'),e+='><table id="'+this.Me+'" class="RespTable"',this.FullWidth&&(e+=' style="width: 100%"'),e+=">",e+=this.html(),e+="</table></div>",this.Preserve?t.insertAdjacentHTML("beforeend",e):t.innerHTML=e,this.bindEvents(),!this.NoControls){let e=LinkCtrl.buttonBar([{Label:"",Title:"Remove all items",Icon:{Type:"Reset"},Click:function(){this.confirmForm("RESET",this.empty.bind(this))}.bind(this)},{Label:"",Title:"Remove selected item",Icon:{Type:"Delete"},Click:function(){this.confirmForm("DELETE",this.removeRows.bind(this),this.SelectedIndices)}.bind(this)},{Label:"",Title:"Move selected item up",Icon:{Type:"Up"},Click:function(){this.up()}.bind(this)},{Label:"",Title:"Move selected item down",Icon:{Type:"Down"},Click:function(){this.down()}.bind(this)},{Label:"",Title:"Move selected item to the top",Icon:{Type:"Top"},Click:function(){this.top()}.bind(this)},{Label:"",Title:"Move selected item to the bottom",Icon:{Type:"Bottom"},Click:function(){this.bottom()}.bind(this)}]);t.prepend(e)}return this}bindEvents(){GetId(this.Me).addEventListener("click",function(t){let e=this.Selected,i=this.SelectedIndices,s=t.target;if(!(this.Delegate&&(s.nodeName==this.Delegate.On&&this.Delegate.Function(t),this.Delegate.Cancel)||"TH"==s.nodeName)){if("TD"==s.nodeName)var n=s.parentElement.rowIndex-1;else n=s.parentElement.parentElement.rowIndex-1;this.Multiple?this.Array[n].Selected=!this.Array[n].Selected:this.Array.forEach((function(t,e){t.Selected=e==n})),this.update({Action:"Select"}),this.onSelect&&this.onSelect(this.Selected,e,this.SelectedIndices,i)}}.bind(this))}html(){let t=this.headers();return void 0===this.Array||this.Array.forEach((function(e,i){t+='<tr class="RespTable_Row',e.Selected&&(t+=" RespTable_Selected"),e.Status&&"Error"==e.Status&&(t+=" RespTable_Error"),t+='">',this.RowNumbers&&(t+="<td>"+(i+1)+"</td>"),this.extractData(e).forEach((function(e){t+="<td>"+e+"</td>"})),t+="</tr>"}),this),t}headers(){if(this.Headers)var t=this.Headers;else{if(!this.Fields)return"";t=this.Fields}var e="<tr>";return this.RowNumbers&&(e+="<th>#</th>"),t.forEach((function(t){e+="<th>"+t+"</th>"})),e+="</tr>"}extractData(t){if(this.Fields){var e=[],i=Object.keys(t),s=Object.values(t);return this.Fields.forEach((function(t){let n=i.findIndex((function(e){return e==t})),l=s[n];n>-1?"Color"==t||"color"==t?e.push('<span style="background-color: '+l+'; border: 1px solid black">&nbsp;&nbsp;&nbsp;&nbsp;</span>'):"boolean"==typeof l?l?e.push('<span style="color: darkgreen; font-weight: bold;">&check;</span>'):e.push('<span style="color: tomato; font-weight: bold;">&cross;</span>'):e.push(l):e.push("")})),e}return t}update(t){let e=GetId(this.Me);return null==e||(e.innerHTML=this.html(),this.onUpdate&&this.onUpdate(t)),this}addRow(t){return this.Array.push(t),this.update({Action:"Add Row"}),t}removeRows(t){if(0==t.length)return this;let e=this.Array.filter((function(e,i){let s=t.includes(i);return s&&this.onDelete&&this.onDelete(e),!s}),this);return this.Array=e,this.update({Action:"Remove Row"}),this}up(){let t=this.SelectedIndices.length;if(0==t||t>1)return this;let e=this.SelectedIndices[0];if(0==e)return this;let i=this.Array[e-1];return this.Array[e-1]=this.Array[e],this.Array[e]=i,this.update({Action:"Up"}),this}down(){let t=this.SelectedIndices.length;if(0==t||t>1)return this;let e=this.SelectedIndices[0];if(e==this.Length-1)return this;let i=this.Array[e+1];return this.Array[e+1]=this.Array[e],this.Array[e]=i,this.update({Action:"Down"}),this}top(){let t=this.SelectedIndices.length;if(0==t||t>1)return this;let e=this.SelectedIndices[0];if(0==e)return this;let i=this.Array.splice(e,1);this.Array.unshift(i[0]),this.update({Action:"Top"})}bottom(){let t=this.SelectedIndices.length;if(0==t||t>1)return this;let e=this.SelectedIndices[0];if(e==this.Length-1)return this;let i=this.Array.splice(e,1);this.Array.push(i[0]),this.update({Action:"Bottom"})}empty(){return this.onDelete&&this.Array.forEach((function(t){this.onDelete(t)}),this),this.Array=[],this.update({Action:"Empty"}),this}setValue(t){return this.Array.forEach((function(e,i){let s=t.includes(i);e.Selected=!!s})),this.update({Action:"Set Value"}),this}selectAll(){this.Array.forEach((function(t){t.Selected=!0})),this.update({Action:"Set Value"})}hideControls(){return GetId(this.ID).firstChild.style.display="none",this}showControls(){return GetId(this.ID).firstChild.style.display="block",this}hasElement(t,e){for(var i=!1,s=this.Array,n=s.length,l=0;!i&&l<n;){var r=Object.keys(s[l]).findIndex((function(e){return e==t}));r>-1&&(i=Object.values(s[l])[r]==e),l++}return i}confirmForm(t,e,i){if(0==this.Length)return this;let s=this.ID+"_Form",n="The selected row(s) will be deleted.";return"RESET"==t&&(n="This will remove all rows from this table."),Form.open({ID:s,HTML:'<div style="text-align: center"><p style="color: red;">'+n+"</p><p>Are you sure you want to continue?</p></div>",Title:"Confirm deletion",Buttons:[{Label:"Ok",Click:function(){e(i),Form.close(s)}.bind(this)},{Label:"Cancel",Click:function(){Form.close(s)}}]}),this}}class TabControl{constructor(t){return this.ID=t.ID,this.Tabs=[],this.LastKey=0,this.Preserve=t.Preserve||!1,this.AutoInit=t.AutoInit||!1,this.Multiple=t.Multiple||!1,this.Disabled=t.Disabled||!1,this.Stack=t.Stack,this.Layout=t.Layout||"Horizontal",this.AfterDelete=t.AfterDelete||function(t){},t.Tabs&&t.Tabs.forEach((function(t,e){t.Key=e,t.Parent=this,this.Disabled&&(t.Disabled=!0),this.Tabs.push(new TabPanel(t)),this.LastKey++}),this),this.AutoInit&&this.init(),this}getTabIndex(t){var e=this.Tabs.length;for(let i=0;i<e;i++)if(this.Tabs[i].Key==t)return i;return-1}indexForLabel(t){var e=this.Tabs.length;for(let i=0;i<e;i++)if(this.Tabs[i].Label==t)return i;return-1}disable(){return this.Disabled=!0,this.Tabs.forEach((function(t){t.set("Disabled")})),this}enable(){return this.Disabled=!1,this.Tabs.forEach((function(t){t.set("Enabled")})),this}active(){if(this.Multiple){var t=[];return this.Tabs.forEach((function(e,i){e.Active&&t.push(i)})),t}var e=this.Tabs.length;for(let t=0;t<e;t++)if(this.Tabs[t].Active)return t}init(){if(0==this.Tabs.length)return this;var t=GetId(this.ID);if(null==t)return this;t.classList.contains("LinkCtrl_Tab")||t.classList.add("LinkCtrl_Tab"),t.classList.contains("LinkCtrl_Round")||t.classList.add("LinkCtrl_Round");var e="";switch(this.Layout){case"Horizontal":e+='<div class="LinkCtrl_TabHeaders">',this.Tabs.forEach((function(t,i){e+=t.initHeader()})),e+="</div>",e+='<div class="LinkCtrl_TabContents">',this.Tabs.forEach((function(t){e+=t.initContent()})),e+="</div>";break;case"Menu":this.Tabs.forEach((function(t){e+='<div class="LinkCtrl_TabHeaders">'+t.initHeader()+"</div>",e+='<div class="LinkCtrl_TabContents">'+t.initContent()+"</div>"}));break;case"Vertical":e+='<div class="LinkCtrl_TabHeaders" style="float: left;">',this.Tabs.forEach((function(t,i){e+=t.initHeader()+"<br>"})),e+="</div>",e+='<div class="LinkCtrl_TabContents">',this.Tabs.forEach((function(t){e+=t.initContent()})),e+="</div>";break;default:return this}return this.Preserve?t.insertAdjacentHTML("beforeend",e):t.innerHTML=e,this.bindEvents(),this}bindEvents(t){let e=GetId(this.ID);if(null==e)return;let i=this.Tabs;return t&&(i=[this.Tabs[t]]),i.forEach((function(t,e){GetId(t.Anchors.Header).addEventListener("click",this.click.bind(this))}),this),this}click(t){let e=t.target,i=Number(e.getAttribute("tabKey")),s=this.getTabIndex(i);if(e.hasAttribute("tabaction"))switch(e.getAttribute("tabAction")){case"Setting":case"Edit":case"Move":break;case"Delete":this.deleteConfirm(s)}else if(e.classList.contains("LinkCtrl_Active"))this.Multiple?this.Tabs[s].set("Resting"):this.Tabs[s].fold();else{if(e.classList.contains("LinkCtrl_Disabled"))return;this.jumpTo(s)}return this}jumpTo(t){return this.Tabs[t].set("Active"),this.Multiple||this.Tabs.forEach((function(e,i){e.Active&&i!=t&&e.set("Resting")})),this}setOpen(t){return this.Multiple&&this.Tabs.forEach((function(e,i){t.includes(i)?e.set("Active"):e.set("Resting")})),this}closeAll(){return this.Tabs.forEach((function(t){t.set("Resting")})),this}openAll(){return this.Tabs.forEach((function(t){t.set("Active")})),this}addTabs(t){return t.forEach((function(t){this.addTab(t)}),this),this}addTab(t){if(void 0===t)return this;t.Key=this.LastKey,t.Parent=this,t.Active=!1,this.Disabled&&(t.Disabled=!0),this.Tabs.push(new TabPanel(t));let e=this.Tabs.length-1;return 0==this.LastKey?this.init():this.addTabHTML(e),t.SetActive&&this.jumpTo(e),this.LastKey++,this.Tabs[e+1]}addTabHTML(t){var e=GetId(this.ID);if(null!=e&&e.classList.contains("LinkCtrl_Tab")){var i=this.Tabs[t];switch(this.Layout){case"Menu":e.insertAdjacentHTML("beforeend",'<div class="LinkCtrl_TabHeaders">'+i.initHeader()+'</div><div class="LinkCtrl_TabContents">'+i.initContent()+"</div>");break;case"Horizontal":e.children[0].insertAdjacentHTML("beforeend",i.initHeader()),e.children[1].insertAdjacentHTML("beforeend",i.initContent());break;case"Vertical":e.children[0].insertAdjacentHTML("beforeend",i.initHeader()+"<br>"),e.children[1].insertAdjacentHTML("beforeend",i.initContent());break;default:return}return e.style.display="block",this.bindEvents(t),this}}deleteConfirm(t){var e=this,i="Form_DeleteTab";return Form.open({ID:i,HTML:'<div style="text-align: center"><p style="color: red;">This will delete the tab and all its contents.</p><p>Are you sure you want to continue?</p></div>',Title:"Confirm deletion",Buttons:[{Label:"Ok",Click:function(){e.deleteTab(t),e.AfterDelete(t),Form.close(i)}},{Label:"Cancel",Click:function(){Form.close(i)}}],Size:500}),this}deleteTab(t){var e=this.Tabs,i=e.length;if(void 0===e[t])return this;if(!this.Multiple&&e[t].Active&&(0==t&&i>1&&this.jumpTo(1),t>0&&this.jumpTo(t-1)),e[t].delete(),e.splice(t,1),0==e.length){var s=GetId(this.ID);null===s&&void 0===s||(s.style.display="none")}return this}rename(t,e){return this.Tabs[t].rename(e),this}}class TabPanel{constructor(t){this.Key=t.Key,this.Parent=t.Parent,this.Label=t.Label||"",this.Active=t.Active||!1,this.Disabled=t.Disabled||!1,this.Controls=t.Controls||[],this.Content=t.Content;var e=this.Parent.ID;return this.Anchors={Header:e+"_TabHeader_"+this.Key,Content:e+"_TabContent_"+this.Key},this.initContentInternal(),this}classHeader(){var t="LinkCtrl LinkCtrl_RoundT";return this.Active?t+=" LinkCtrl_Active":this.Disabled?t+=" LinkCtrl_Disabled":t+=" LinkCtrl_Resting",t}initHeader(){var t="<span ";return t+='id="'+this.Anchors.Header+'" ',t+='class="'+this.classHeader()+'" ',t+='tabKey="'+this.Key+'" style="font-size: 1em; white-space: pre">'+this.Label,this.Controls.length>0&&(t+=this.appendControls()),t+="</span> "}appendControls(){let t="";return this.Controls.forEach((function(e){let i={Type:e,Active:this.Active,Space:!0,Attributes:[{Name:"tabKey",Value:this.Key},{Name:"tabAction",Value:e}]};if(!this.Disabled)switch(e){case"Setting":i.Title="Click here to see the settings for this tab";break;case"Edit":i.Title="Click here to edit the tab";break;case"Move":i.Title="Click here to move this tab at the desired position";break;case"Delete":i.Title="Click here to delete this tab"}t+=LinkCtrl.icon(i)}),this),t}initContent(){let t="",e="none";return this.Active&&(e="block"),this.Parent.Stack||(e+="; float: left"),t+='<div id="'+this.Anchors.Content+'" class="LinkCtrl_TabPanel" style="display: '+e+'">',t+=this.initContentInternal(),t+="</div>",t}initContentInternal(){let t=this.Content;if(void 0===t)return"";switch(t.Type){case"HTML":return t.Value;case"DOM":if(t.Value){let e=GetId(t.Value);if(null!=e){let t=e.innerHTML;return this.Content={Type:"HTML",Value:t},e.remove(),t}}return"";default:return""}}updateState(){var t=GetId(this.Anchors.Header);null!=t&&(t.className=this.classHeader(),this.Controls.length>0?t.innerHTML=this.Label+"&nbsp;"+this.appendControls():t.innerHTML=this.Label);var e=GetId(this.Anchors.Content);null!=e&&(this.Active?e.style.display="block":e.style.display="none")}updateContent(t){this.Content=t;var e=GetId(this.Anchors.Content);null!=e&&(e.innerHTML=this.initContentInternal())}set(t){return t.split(" ").forEach((function(t){switch(t){case"Active":this.Active=!0;break;case"Resting":this.Active=!1;break;case"Disabled":this.Disabled=!0;break;case"Enabled":this.Disabled=!1}}),this),this.updateState(),this}fold(){var t=GetId(this.Anchors.Content);null!=t&&("none"==t.style.display?t.style.display="block":t.style.display="none")}delete(){var t=GetId(this.Anchors.Header);null!=t&&("Vertical"==this.Parent.Layout&&t.nextElementSibling.remove(),t.remove());var e=GetId(this.Anchors.Content);null!=e&&e.remove()}rename(t){this.Label=t,this.updateState()}}class LinkCtrl_Checkbox extends LinkCtrl{constructor(t){return super(t),this.Type="Checkbox",this}html(){var t="";this.Value&&(t=" checked");var e='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">';return this.ControlLeft?(e+='<input type="checkbox" id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_ChkBox"'+t+">",this.HasLabel&&(e+="&nbsp;"+this.Label)):(this.HasLabel&&(e+=this.Label+"&nbsp;"),e+='<input type="checkbox" id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_ChkBox"'+t+">"),e+="</label>",this.NewLine&&(e+="<br>"),e}bindEvents(){GetId(this.Me).children[0].addEventListener("click",function(t){var e=t.target.checked;this.Value=e;var i=t.target.parentElement.classList;e?i.replace("LinkCtrl_Resting","LinkCtrl_Active"):i.replace("LinkCtrl_Active","LinkCtrl_Resting"),this.change(e)}.bind(this))}updateValue(t,e){if(this.Value=t,e){e.children[0].checked=t;var i=e.classList;t?i.replace("LinkCtrl_Resting","LinkCtrl_Active"):i.replace("LinkCtrl_Active","LinkCtrl_Resting")}}}class LinkCtrl_Color extends LinkCtrl{constructor(t){return super(t),this.Type="Color",this}html(){var t='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">';return this.ControlLeft?(t+='<span id="'+this.Control+'" class="LinkCtrl_Color" title="'+this.Title+'" style="background-color: '+this.Value+'">&nbsp;&nbsp;&nbsp;&nbsp;</span>',this.HasLabel&&(t+="&nbsp;"+this.Label)):(this.HasLabel&&(t+=this.Label+"&nbsp;"),t+='<span id="'+this.Control+'" class="LinkCtrl_Color" title="'+this.Title+'" style="background-color: '+this.Value+'">&nbsp;&nbsp;&nbsp;&nbsp;</span>'),t+="</label>",this.NewLine&&(t+="<br>"),t}bindEvents(){GetId(this.Me).addEventListener("click",function(t){Form_Color({Caller:this,after:this.change})}.bind(this))}updateValue(t,e){this.Value=t,e&&(e.children[0].style.backgroundColor=t)}}class LinkCtrl_File extends LinkCtrl{constructor(t){return super(t),this.Type="File",this.Multiple=t.Multiple,this.Accept=t.Accept,this.DragMsg="Drag and drop your files here",this}static dropMsg(t){return'<div class="LinkCtrl_FileDropInner" ondragenter="event.target.remove()">'+t+"</div>"}html(){let t="";t+='<span title="Reset the file selection" class="LinkCtrl LinkCtrl_Round LinkCtrl_Resting">Clear</span>&nbsp;',t+='<span id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">',t+="Browse...";let e="";this.Multiple&&(e="multiple");let i="";return this.Accept&&(i=" accept="+this.Accept),t+='<input type="file" id="'+this.Control+'" style="display: none" '+e+i+">",t+="</span>",t+=this.fileInfo(),t+='<div class="LinkCtrl_FileDrop">'+LinkCtrl_File.dropMsg(this.DragMsg)+"</div>",this.NewLine&&(t+="<br>"),t}bindEvents(){let t=GetId(this.Me),e=t.children[0],i=t.previousElementSibling;t.addEventListener("click",(function(){e.click()})),e.addEventListener("change",function(){this.Value=e.files,t.nextElementSibling.remove(),t.insertAdjacentHTML("afterend",this.fileInfo()),this.change(e.files)}.bind(this)),i.addEventListener("click",function(){this.Value=[],t.nextElementSibling.remove(),t.insertAdjacentHTML("afterend",this.fileInfo()),this.change()}.bind(this));let s=t.nextElementSibling.nextElementSibling;s.addEventListener("dragenter",(function(t){t.target.className="LinkCtrl_FileDropHover LinkCtrl_FileDrop",t.target.innerHTML="",t.preventDefault()})),s.addEventListener("dragleave",function(t){t.target.className="LinkCtrl_FileDrop",t.target.innerHTML=LinkCtrl_File.dropMsg(this.DragMsg),t.preventDefault()}.bind(this)),s.addEventListener("dragover",(function(t){t.preventDefault()})),s.addEventListener("drop",function(t){t.preventDefault(),t.target.className="LinkCtrl_FileDrop";let e=t.dataTransfer.files,i=e.length,s=[],n=this.Accept.split(",");for(let t=0;t<i;t++)n.forEach((function(i){e[t].name.endsWith(i)&&s.push(e[t])}));let l="";if(0==s.length)l="No valid files found. Supported formats: "+this.Accept,this.setValue([]);else{let t=i-s.length;t>0&&(l=t>1?t+" files with unauthorized format were rejected":"A file with unauthorized format was rejected"),1==this.Multiple?this.setValue(s):(s.length>1&&(l.length>0&&(l+=".<br>"),l+="Only one file allowed! The first valid file was added"),this.setValue([s[0]]))}l.length>0?(t.target.innerHTML=LinkCtrl_File.dropMsg(l),t.target.className="LinkCtrl_FileDrop LinkCtrl_FileDropError"):(t.target.innerHTML=LinkCtrl_File.dropMsg(this.DragMsg),t.target.className="LinkCtrl_FileDrop")}.bind(this))}updateValue(t,e){this.Value=t,e&&(e.nextElementSibling.remove(),e.insertAdjacentHTML("afterend",this.fileInfo()))}fileInfo(){let t="<span",e=this.Value,i=e.length;if(0==i)return t+' style="color: salmon;">&nbsp;No files selected</span>';if(1==i)t+=">&nbsp;"+e[0].name;else{let s=' title="';for(let t=0;t<i;t++)t>0&&(s+=", "),s+=e[t].name;t+=s+'">&nbsp;'+i+" Files selected."}return t+="</span>",t}}class LinkCtrl_Number extends LinkCtrl{constructor(t){return super(t),this.Type="Number",this.Size=t.Size||5,this.Min=t.Min||-1/0,this.Max=t.Max||1/0,this.Step=t.Step||"any",this}html(){var t='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">';return this.ControlLeft?(t+=this.htmlInput(),this.HasLabel&&(t+="&nbsp;"+this.Label)):(this.HasLabel&&(t+=this.Label+"&nbsp;"),t+=this.htmlInput()),t+="</label>",this.NewLine&&(t+="<br>"),t}htmlInput(){var t='<input type="number" id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_Number" value="'+this.Value+'" style="width: '+this.Size+'em"';return void 0!==this.Min&&(t+=' min="'+this.Min+'"'),void 0!==this.Max&&(t+=' max="'+this.Max+'"'),this.Disabled&&(t+=" disabled"),t+=' step="'+this.Step+'">'}bindEvents(){GetId(this.Me).children[0].addEventListener("change",function(t){let e=t.target;var i=Number(e.value);let s=!1;i>this.Max&&(i=this.Max,s=!0),i<this.Min&&(i=this.Min,s=!0),e.style.color=s?"red":"black",e.value=i,this.Value=i,this.change(i)}.bind(this))}updateValue(t,e){let i=Number(t);i>this.Max&&(i=this.Max),i<this.Min&&(i=this.Min),this.Value=i,e&&(e.children[0].value=i)}setMin(t){this.Min=t,this.Value<t&&this.setValue(t);let e=GetId(this.Control);return e&&(e.min=t),this}setMax(t){this.Max=t,this.Value>t&&this.setValue(t);let e=GetId(this.Control);return e&&(e.max=t),this}disable(){this.Disabled=!0;let t=GetId(this.Me);return t&&(t.children[0].disabled=!0,t.classList.replace("LinkCtrl_Resting","LinkCtrl_Disabled")),this}enable(){this.Disabled=!1;let t=GetId(this.Me);t&&(t.children[0].disabled=!1,t.classList.replace("LinkCtrl_Disabled","LinkCtrl_Resting"))}}class LinkCtrl_Radio extends LinkCtrl{constructor(t){return super(t),this.Type="Radio",this.List=t.List||[],this}get Selected(){return this.List[this.Value]}html(){let t='<span id="'+this.Me+'" title="'+this.Title+'">',e=this.HasLabel;return e&&(t+='<span class="LinkCtrl'+this.getClass({LeftOnly:!0})+'">'+this.Label+"</span>"),this.List.forEach((function(i,s){let n="";this.Value==s&&(n="checked"),t+='<label for="'+this.Control+"_"+s+'" class="LinkCtrl'+this.classes(s,e)+'">',this.ControlLeft?(t+='<input type="radio" id="'+this.Control+"_"+s+'" name="'+this.Control+'" '+n+' itemNb="'+s+'">',t+=i):(t+=i,t+='<input type="radio" id="'+this.Control+"_"+s+'" name="'+this.Control+'" '+n+' itemNb="'+s+'">'),t+="</label>"}),this),t+="</span>",this.NewLine&&(t+="<br>"),t}bindEvents(){let t=GetId(this.Me).children,e=t.length,i=0;for(this.HasLabel&&(t[0].addEventListener("click",function(t){let e=this.List.length,i=this.Value+1;i<e?this.setValue(i).change(i):this.setValue(0).change(0)}.bind(this)),i++);i<e;)t.item(i).children[0].addEventListener("click",function(t){let e=Number(t.target.getAttribute("itemNb"));this.updateValue(e,t.target.parentElement.parentElement),this.change(e)}.bind(this)),i++}updateValue(t,e){let i=Number(t);if(isNaN(i)||i<0||i>=this.List.length)console.warn("Could not update Radio control with the value given ("+i+")");else{if(e){let t=e.children.item(i);if(this.HasLabel&&(t=e.children.item(i+1)),t){let i=e.children.item(this.Value);this.HasLabel&&(i=e.children.item(this.Value+1)),i&&(i.children[0].checked=!1,i.classList.replace("LinkCtrl_Active","LinkCtrl_Resting")),t.children[0].checked=!0,t.classList.replace("LinkCtrl_Resting","LinkCtrl_Active")}}this.Value=i}}classes(t,e){let i=" LinkCtrl_Resting";return this.Value==t&&(i=" LinkCtrl_Active"),0==t&&0==e&&(i+=" LinkCtrl_RoundL"),t==this.List.length-1&&(i+=" LinkCtrl_RoundR"),i}}class LinkCtrl_Select extends LinkCtrl{constructor(t){return super(t),this.Type="Select",this.List=t.List||[],this.NavBar=t.NavBar,t.Lookup&&(this.Lookup={Active:!1,Query:"",Values:[],LastVisited:0}),this}get Selected(){return this.List[this.Value]}html(){let t="";if(this.NavBar){let e=this.getClass({ForceMiddle:!0});t+='<span style="white-space: pre">',t+='<span class="LinkCtrl'+this.getClass({LeftOnly:!0})+'" title="Move to the first element" style="padding: 0.5em 0.2em;">'+LinkCtrl.icon({Type:"First"})+"</span>",t+='<span class="LinkCtrl'+e+'" title="Move one element backward" style="border-right: none; border-left: none; padding: 0.5em 0.2em;">'+LinkCtrl.icon({Type:"Left"})+"</span>",t+='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+e+'">',t+=this.htmlInternal(),t+="</label>",t+='<span class="LinkCtrl'+e+'" title="Move one element forward" style="border-right: none; border-left: none; padding: 0.5em 0.2em">'+LinkCtrl.icon({Type:"Right"})+"</span>",t+='<span class="LinkCtrl'+this.getClass({RightOnly:!0})+'" title="Move to the last element" style="padding: 0.5em 0.2em">'+LinkCtrl.icon({Type:"Last"})+"</span>",t+="</span>"}else t+='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">',t+=this.htmlInternal(),t+="</label>";return this.NewLine&&(t+="<br>"),t}htmlInternal(){let t="";return this.ControlLeft?(t+=this.htmlInput(),this.HasLabel&&(t+="&nbsp;"+this.Label)):(this.HasLabel&&(t+=this.Label+"&nbsp;"),t+=this.htmlInput()),this.Lookup&&(t+=this.htmlLookup()),t}htmlInput(){let t='<select id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_Select">';return t+=this.htmlOptions(),t+="</select>",t}htmlLookup(){let t=LinkCtrl.icon({Type:"Zoom",Title:"Click here to search values in the list",Active:!1,Space:!0});return t+='<div class="LinkCtrl_SelectLookup" style="display: none">',t+='<input type="text" size="15" title="Type your search here and press enter to navigate the results">',t+='<div style="line-height: normal; color: black"></div>',t+="</div>",t}bindEvents(t){let e=GetId(this.Me);if(e.children[0].addEventListener("change",function(t){var e=t.target.selectedIndex;this.Value=e,this.change(e)}.bind(this)),this.Lookup){let t=e.children[1],i=e.children[2],s=i.children[0],n=i.children[1],l=void 0;t.addEventListener("click",function(l){let r=i.style;0==this.Lookup.Active?(t.classList.replace("LinkCtrl_IconResting","LinkCtrl_IconActive"),e.classList.replace("LinkCtrl_Resting","LinkCtrl_Active"),r.display="block",r.left=t.offsetLeft-20+"px",this.Lookup={Active:!0,Values:[],LastVisited:0,Query:""},window.setTimeout((function(){s.focus()}),0)):(this.Lookup.Active=!1,r.display="none",t.classList.replace("LinkCtrl_IconActive","LinkCtrl_IconResting"),e.classList.replace("LinkCtrl_Active","LinkCtrl_Resting"),s.value="",n.innerHTML="")}.bind(this)),s.addEventListener("keyup",function(t){let e=this.Lookup,i=s.value;if(""!=i)if("Enter"==t.key){if(0==e.Values.length)return void(n.innerHTML="");{let t=e.Values[e.LastVisited];this.setValue(t).change(t),e.LastVisited++,e.LastVisited==e.Values.length&&(e.LastVisited=0)}}else{e.Query=i;let t=new Promise(function(t){let e=[],s=new RegExp(i,"i");this.List.forEach((function(t,i){s.test(t)&&e.push(i)})),t(e)}.bind(this));l&&clearTimeout(l),l=setTimeout((function(){n.innerHTML="Searching...",t.then((function(t){e.Values=t,e.LastVisited=0;let l=t.length,r="";switch(l){case 0:r="No match!";break;case 1:r="Found 1 match";break;default:r="Found "+l+" matches"}s.value==i?n.innerHTML=r:""==s.value&&(n.innerHTML="")}))}),200)}else n.innerHTML=""}.bind(this))}if(this.NavBar){let t=e.previousSibling,i=t.previousSibling,s=e.nextSibling,n=s.nextSibling;i.addEventListener("click",function(t){this.setValue(0).change(0)}.bind(this)),n.addEventListener("click",function(t){let e=this.List.length-1;this.setValue(e).change(e)}.bind(this)),s.addEventListener("click",function(t){let e=this.List.length-1,i=this.Value;i<e&&this.setValue(i+1).change(i+1)}.bind(this)),t.addEventListener("click",function(t){let e=this.Value;e>0&&this.setValue(e-1).change(e-1)}.bind(this))}return this}updateValue(t,e){return this.Value=t,e&&(e.children[0].selectedIndex=t),this}htmlOptions(){var t="",e="";return this.List.forEach((function(i,s){e=s==this.Value?"selected":"",t+='<option value="'+s+'" '+e+">"+i+"</option>"}),this),t}updateList(t){this.List=t,this.Value>=t.length&&(this.Value=t.length-1);let e=GetId(this.Control);return null===e||(e.innerHTML=this.htmlOptions()),this}disable(){var t=GetId(this.Me);return null===t||(t.children[0].disabled=!0,this.NavBar),this}}class LinkCtrl_Text extends LinkCtrl{constructor(t){return super(t),this.Type="Text",this.Size=t.Size||12,this}html(){var t='<label id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl'+this.Classes+'">';return this.ControlLeft?(t+='<input type="text" id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_Text" value="'+this.Value+'" size="'+this.Size+'">',this.HasLabel&&(t+="&nbsp;"+this.Label)):(this.HasLabel&&(t+=this.Label+"&nbsp;"),t+='<input type="text" id="'+this.Control+'" title="'+this.Title+'" class="LinkCtrl_Text" value="'+this.Value+'" size="'+this.Size+'">'),t+="</label>",this.NewLine&&(t+="<br>"),t}bindEvents(){GetId(this.Me).children[0].addEventListener("change",function(t){var e=t.target.value;this.Value=e,this.change(e)}.bind(this))}updateValue(t,e){this.Value=t,e&&(e.children[0].value=t)}}class LinkCtrl_TextArea extends LinkCtrl{constructor(t){return super(t),this.Type="TextArea",this}html(){let t='<textarea id="'+this.Me+'" title="'+this.Title+'" class="LinkCtrl_Round LinkCtrl_TextArea';return this.Disabled?t+=' LinkCtrl_TextAreaDisabled"':t+=' LinkCtrl_TextAreaEnabled"',this.Disabled&&(t+=" disabled"),t+=' value="'+this.Value+'">'+this.Value+"</textarea>",this.NewLine&&(t+="<br>"),t}bindEvents(){return GetId(this.Me).addEventListener("change",function(t){var e=t.target.value;this.Value=e,this.change(e)}.bind(this)),this}updateValue(t,e){return this.Value=t,e&&(e.value=t),this}disable(){let t=GetId(this.Me);return t&&(t.disabled=!0,t.classList.replace("LinkCtrl_TextAreaEnabled","LinkCtrl_TextAreaDisabled")),this}}
//# sourceMappingURL=ui.min.js.map
